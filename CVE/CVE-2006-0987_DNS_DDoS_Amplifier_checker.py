# Testing CVE-2006-0987

# Modified by Kapi.Zionspike

import socket
import binascii
from scapy.all import DNS #Bring in scapy's DNS decoder

# build UPD packet

class bcolors:
    HEADER = '\033[95m'
    OKBLUE = '\033[94m'
    OKGREEN = '\033[92m'
    WARNING = '\033[93m'
    FAIL = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

try:
	print "[!] Tesing CVE-2006-0987 DNS DDoS Amplifier"
	print "[!] Packing Data"
	target = "etraining.set.or.th"
	UDP_IP_ADDRESS = target
	UDP_PORT_NO = 53
	Message = "\x51\x84\x00\x10\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x01"
	clientSock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
	clientSock.sendto(Message, (UDP_IP_ADDRESS, UDP_PORT_NO))
	
	print "[!] Data is ready"
	print "[!] Sending DNS request to DNS server: " + target
	data, addr = clientSock.recvfrom(1024)
	print "[+] Receive from:", addr
	print "[!] Sent data lenght: " + str(len(Message)) + " bytes"
	print "[!] Receive data lenght: " + str(len(data)) + " bytes"
	if len(data) > len(Message)*20:
		print bcolors.FAIL +  "[+] The server is vulnerable to DDoS:" + bcolors.ENDC
		print bcolors.FAIL +  "   [+] The response is larger than 20 times of request" + bcolors.ENDC
	print "Response: ", str(DNS(data).show())
except Exception as e:
	raise e






